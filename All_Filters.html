<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DSP Filter Studio - Logarithmic Accuracy</title>
<style>
    @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap');

    body {
        font-family: 'Roboto', sans-serif;
        background-color: #f4f6f9;
        color: #1f2937;
        text-align: center;
        padding: 30px;
        margin: 0;
    }

    .container {
        background: white;
        padding: 40px;
        border-radius: 16px;
        max-width: 800px;
        margin: auto;
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
        border: 1px solid #e5e7eb;
    }

    h1 { font-weight: 700; color: #111827; margin-bottom: 10px; }
    p.subtitle { color: #6b7280; margin-bottom: 25px; }

    #playBtn {
        background: #10b981;
        color: white;
        border: none;
        padding: 15px 30px;
        font-size: 18px;
        font-weight: bold;
        border-radius: 8px;
        cursor: pointer;
        transition: 0.2s;
        margin-bottom: 25px;
    }

    #playBtn:hover { background: #059669; }

    .button-group {
        display: flex;
        justify-content: center;
        gap: 10px;
        flex-wrap: wrap;
        margin-bottom: 30px;
    }

    .filter-btn {
        background: #f3f4f6;
        padding: 10px 18px;
        border: 1px solid #d1d5db;
        border-radius: 8px;
        cursor: pointer;
        font-weight: 600;
    }

    .filter-btn.active {
        background: #2563eb;
        color: white;
        border-color: #1d4ed8;
    }

    .slider-container {
        background: #f9fafb;
        padding: 20px;
        border-radius: 12px;
        margin-bottom: 40px;
        border: 1px solid #e5e7eb;
    }

    input[type=range] { width: 100%; cursor: pointer; }

    .graph-wrapper {
        background: #ffffff;
        padding: 30px 20px;
        border-radius: 14px;
        border: 1px solid #e5e7eb;
    }

    .graph {
        display: flex;
        justify-content: space-around;
        align-items: flex-end;
        height: 250px;
        margin-bottom: 25px;
    }

    .subject {
        display: flex;
        flex-direction: column;
        justify-content: flex-end;
        align-items: center;
        width: 22%;
        height: 100%;
    }

    .bar-container {
        width: 100%;
        height: 100%;
        background: #f3f4f6;
        border-radius: 8px;
        display: flex;
        align-items: flex-end;
        border: 1px solid #e5e7eb;
        overflow: hidden;
    }

    .bar {
        width: 100%;
        border-radius: 4px 4px 0 0;
        transition: height 0.2s ease-out;
        height: 100%;
    }

    .low-bar { background: #f97316; }
    .mid-bar { background: #16a34a; }
    .high-bar { background: #7c3aed; }

    .labels-row { display: flex; justify-content: space-around; }
    .label-box { width: 30%; text-align: center; }
    .emoji { font-size: 40px; margin-bottom: 6px; }
    .label-text { font-size: 15px; font-weight: 700; color: #111827; }
    .label-sub { font-size: 13px; color: #6b7280; font-weight: 600; }

</style>
</head>
<body>

<div class="container">
    <h1>DSP Filter Studio</h1>
    <p class="subtitle">Logarithmic Scaling: Real Frequencies, Equal Spacing.</p>

    <audio id="audioHum" src="factory-hum.mp3" loop></audio>
    <audio id="audioMan" src="man-speaking.mp3" loop></audio>
    <audio id="audioBird" src="bird-chirp.wav" loop></audio>

    <button id="playBtn" onclick="togglePlayback()">‚ñ∂ Start Audio</button>

    <div class="button-group">
        <button class="filter-btn active" onclick="changeMode('none', this)">Bypass</button>
        <button class="filter-btn" onclick="changeMode('lowpass', this)">Low-Pass</button>
        <button class="filter-btn" onclick="changeMode('highpass', this)">High-Pass</button>
        <button class="filter-btn" onclick="changeMode('bandpass', this)">Band-Pass</button>
        <button class="filter-btn" onclick="changeMode('notch', this)">Notch</button>
    </div>

    <div class="slider-container">
        <label>Filter Cutoff: <span id="freqVal" style="color:#2563eb; font-weight:bold;">1000</span> Hz</label>
        <input type="range" id="freqSlider" min="0" max="100" value="50" oninput="processAudio()">
    </div>

    <div class="graph-wrapper">
        <div class="graph">
            <div class="subject">
                <div class="bar-container"><div id="vHum" class="bar low-bar"></div></div>
            </div>
            <div class="subject">
                <div class="bar-container"><div id="vMan" class="bar mid-bar"></div></div>
            </div>
            <div class="subject">
                <div class="bar-container"><div id="vBird" class="bar high-bar"></div></div>
            </div>
        </div>

        <div class="labels-row">
            <div class="label-box">
                <div class="emoji">üè≠</div>
                <div class="label-text">Factory Hum</div>
                <div class="label-sub">100 Hz</div>
            </div>
            <div class="label-box">
                <div class="emoji">üë®</div>
                <div class="label-text">Man Speaking</div>
                <div class="label-sub">1,000 Hz</div>
            </div>
            <div class="label-box">
                <div class="emoji">üê¶</div>
                <div class="label-text">Bird Chirping</div>
                <div class="label-sub">10,000 Hz</div>
            </div>
        </div>
    </div>
</div>

<script>
    let isPlaying = false;
    let currentMode = 'none';
    
    // Technically Real Frequencies
    const humFreq = 100;   
    const manFreq = 1000;  
    const birdFreq = 10000;

    const audios = {
        hum: document.getElementById('audioHum'),
        man: document.getElementById('audioMan'),
        bird: document.getElementById('audioBird')
    };

    const bars = {
        hum: document.getElementById('vHum'),
        man: document.getElementById('vMan'),
        bird: document.getElementById('vBird')
    };

    function togglePlayback() {
        if (!isPlaying) {
            Object.values(audios).forEach(a => { a.volume = 1.0; a.play(); });
            document.getElementById('playBtn').innerText = "‚è∏ Stop Audio";
            document.getElementById('playBtn').style.background = "#ef4444";
            isPlaying = true;
        } else {
            Object.values(audios).forEach(a => a.pause());
            document.getElementById('playBtn').innerText = "‚ñ∂ Start Audio";
            document.getElementById('playBtn').style.background = "#10b981";
            isPlaying = false;
        }
        processAudio();
    }

    function changeMode(mode, btn) {
        currentMode = mode;
        document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        processAudio();
    }

    // Logarithmic Mapping Logic
    function getLogFreq(val) {
        // min 100Hz, max 10,000Hz
        const minFreq = Math.log10(100);
        const maxFreq = Math.log10(10000);
        const scale = (maxFreq - minFreq) / 100;
        return Math.pow(10, minFreq + (val * scale));
    }

    function processAudio() {
        const sliderVal = document.getElementById('freqSlider').value;
        const cutoff = Math.round(getLogFreq(sliderVal));
        document.getElementById('freqVal').innerText = cutoff.toLocaleString();

        const volumes = {
            hum: calculateVolume(humFreq, cutoff, currentMode),
            man: calculateVolume(manFreq, cutoff, currentMode),
            bird: calculateVolume(birdFreq, cutoff, currentMode)
        };

        for (let key in volumes) {
            if (isPlaying) audios[key].volume = volumes[key];
            bars[key].style.height = (volumes[key] * 100) + "%";
        }
    }

    function calculateVolume(soundFreq, cutoff, mode) {
        if (mode === 'none') return 1.0;
        
        // Use octave-based distance for a "real" feel
        const dist = Math.abs(Math.log2(soundFreq / cutoff));

        switch(mode) {
            case 'lowpass':
                return soundFreq < cutoff ? 1.0 : Math.max(0.05, 1 - (dist * 0.8));
            case 'highpass':
                return soundFreq > cutoff ? 1.0 : Math.max(0.05, 1 - (dist * 0.8));
            case 'bandpass':
                return Math.max(0.05, 1 - (dist * 1.2));
            case 'notch':
                return Math.min(1.0, Math.max(0.1, dist * 1.5));
            default:
                return 1.0;
        }
    }

    window.onload = processAudio;
</script>
</body>
</html>
